!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";t.exports=function(t){return"string"==typeof t||t instanceof String}},function(t,e,n){"use strict";t.exports=function(t){return t===Object(t)}},function(t,e,n){"use strict";t.exports=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),i=n(1),a=n.n(i),u=n(2),c=n.n(u);function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o()(t))throw new Error("A first argument should be a string for DOM tag name");if(!a()(e))throw new Error("A second argument should be a object for DOM attributes");var n=document.createElement(t);return Object.keys(e).forEach((function(t){n.setAttribute(t,e[t])})),n}var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events={}}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){if(!o()(t))throw new Error("A first argument should be a string for event name");if(!c()(e))throw new Error("A second argument should be a function");this._events[t]=this._events[t]||[],this._events[t].push(e)}},{key:"emit",value:function(t,e){this._events[t]&&this._events[t].forEach((function(t){return t(e)}))}},{key:"off",value:function(t){this._events[t]&&delete this._events[t]}}])&&l(e.prototype,n),r&&l(e,r),t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=_(t);if(e){var o=_(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g(this,n)}}function g(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}function T(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(i,t);var e,n,r,o=S(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this))._activeCount=0,t._filterMap={all:"all",active:!1,completed:!0},t}return e=i,(n=[{key:"updateActiveCount",value:function(t){return t.completed?this._activeCount-=1:this._activeCount+=1,this._activeCount}},{key:"clearCompletedTodos",value:function(){this._items=this.getFilteredItems("completed",this._filterMap.active),this._activeCount=this._items.length}},{key:"getFilteredTodos",value:function(t){return this.getFilteredItems("completed",this._filterMap[t])}},{key:"activeCount",get:function(){return this._activeCount}}])&&O(e.prototype,n),r&&O(e,r),i}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(i,t);var e,n,r,o=b(i);function i(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return v(this,i),(t=o.call(this))._items=e,t}return e=i,(n=[{key:"getItem",value:function(t){return this._items.find((function(e){return e.id===t}))}},{key:"getItemIndex",value:function(t){return this._items.findIndex((function(e){return e.id===t}))}},{key:"addItem",value:function(t){return this._items.push(t),t}},{key:"updateItem",value:function(t,e){var n=this.getItem(t);return Object.keys(e).forEach((function(t){n[t]=e[t]})),n}},{key:"moveItemTo",value:function(t,e){var n=this.getItemIndex(t.id),r=h(this._items.splice(n,1),1)[0];this._items.splice(e,0,r)}},{key:"removeItem",value:function(t){var e=this._items.findIndex((function(e){return e.id===t}));return e>-1&&(this._items.splice(e,1),!0)}},{key:"getFilteredItems",value:function(t,e){return"all"===e?this._items:this._items.filter((function(n){return n[t]===e}))}},{key:"length",get:function(){return this._items.length}},{key:"items",get:function(){return this._items},set:function(t){this._items=t}}])&&y(e.prototype,n),r&&y(e,r),i}(f));function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var D=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._dragEl=null,this._enterEl=null,this._enterTime=null,this._previewDOM=null,this._previewHTML="",this.srcShift={}}var e,n,r;return e=t,(n=[{key:"draggable",value:function(t){var e=this;document.querySelectorAll(t).forEach((function(t){t.setAttribute("draggable","true"),e.addDragHandlers(t)}))}},{key:"dropzone",value:function(t){var e=this,n=document.querySelector(t),r=new f;return r.target=n,this.addDropHandlers(n),this.customDropHandler=function(t,n){if(r.src=e._dragEl,n&&(r.target=n),r.target!==r.src){var o=r.target.getBoundingClientRect(),i=e.getRectShift(t.clientX,t.clientY,o);r.emit("drop",{e:t,isContain:e.isContain(e.srcShift,i)})}},n.addEventListener("drop",this.customDropHandler.bind(this)),r}},{key:"dragstartHandler",value:function(t){var e=t.currentTarget,n=t.dataTransfer,r=e.getBoundingClientRect();n.dropEffect="move",e.classList.add("drag-element"),this._previewHTML=e.outerHTML,this._dragEl=e,this.srcShift=this.getRectShift(t.clientX,t.clientY,r)}},{key:"dragenterHandler",value:function(t){this._enterEl=t.currentTarget,this._enterTime=Date.now()}},{key:"dragoverHandler",value:function(t){t.preventDefault();var e=t.currentTarget,n=t.dataTransfer,r=Date.now();e.classList.add("drag-over"),n.dropEffect="move",r-this._enterTime>=2e3&&e!==this._dragEl&&(this._previewDOM&&(e.parentNode.removeChild(this._previewDOM),this._previewDOM=null),e.insertAdjacentHTML("beforebegin",this._previewHTML),this._previewDOM=e.previousSibling,this._previewDOM.classList.add("preview"),this._previewDOM.addEventListener("drop",this.dropHandler.bind(this)),this._previewDOM.addEventListener("drop",this.customDropHandler.bind(this,t,e)),this._previewDOM.addEventListener("dragover",this.previewDragoverHandler.bind(this)))}},{key:"dragleaveHandler",value:function(t){t.currentTarget.classList.remove("drag-over")}},{key:"dropHandler",value:function(t){var e=t.currentTarget,n=e.parentNode;e!==this._dragEl&&n.insertBefore(this._dragEl,e),this._previewDOM&&(n.removeChild(this._previewDOM),this._previewDOM=null),e.classList.remove("drag-over"),e.classList.remove("drag-element")}},{key:"dragendHandler",value:function(t){this._previewDOM&&(t.currentTarget.parentNode.removeChild(this._previewDOM),this._previewDOM=null),t.currentTarget.classList.remove("drag-over"),t.currentTarget.classList.remove("drag-element")}},{key:"previewDragoverHandler",value:function(t){t.preventDefault()}},{key:"addDragHandlers",value:function(t){t.addEventListener("dragstart",this.dragstartHandler.bind(this)),t.addEventListener("dragleave",this.dragleaveHandler.bind(this)),t.addEventListener("dragend",this.dragendHandler.bind(this)),t.addEventListener("dragenter",this.dragenterHandler.bind(this))}},{key:"addDropHandlers",value:function(t){t.addEventListener("dragover",this.dragoverHandler.bind(this)),t.addEventListener("drop",this.dropHandler.bind(this))}},{key:"isContain",value:function(t,e){for(var n=Object.keys(e),r=0;r<n.length;r+=1)if(e[n[r]]<t[n[r]])return!1;return!0}},{key:"getRectShift",value:function(t,e,n){var r=e-n.top,o=t-n.left;return{top:r,left:o,right:n.width-o,bottom:n.height-r}}}])&&j(e.prototype,n),r&&j(e,r),t}();function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e){return(H=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=q(t);if(e){var o=q(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return x(this,n)}}function x(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?R(t):e}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&H(t,e)}(a,t);var e,n,r,i=P(a);function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this))._input=document.querySelector(".todo-input input"),t._list=document.querySelector(".todo-list ul"),t._activeCount=document.querySelector(".todo-count"),t._todoFilters=document.querySelector(".todo-filter"),t._todoClear=document.querySelector(".todo-clear"),t._input.addEventListener("keydown",t.handleInput.bind(R(t))),t._todoFilters.addEventListener("click",t.handleFilter.bind(R(t))),t._todoClear.addEventListener("click",t.handleClear.bind(R(t))),t._dnd=new D,t}return e=a,(n=[{key:"load",value:function(t){for(var e=this,n=this._list;n.firstChild;)n.removeChild(n.firstChild);t.forEach((function(t){return e.addTodo(t)}))}},{key:"addTodo",value:function(t){var e=this,n=t.title;if(!o()(n))throw new Error("A first arguments is a string for todo title");if(n){var r=this._list.firstChild||null,i=this.createTodoElement(t);this._list.insertBefore(i,r),this._input.value="",this._dnd.draggable("#todo-".concat(t.id));var a=this._dnd.dropzone("#todo-".concat(t.id));a.on("drop",(function(t){e.emit("drop",{e:t,dropzone:a})}))}}},{key:"updateTodo",value:function(t){var e=this._list,n=e.querySelector('label[data-id="'.concat(t.id,'"]')),r=n.parentNode,o=r.querySelector("input");t.completed?(e.appendChild(r),o.checked="checked",n.classList.add("completed")):(e.insertBefore(r,e.firstChild),o.checked="",n.classList.remove("completed"))}},{key:"updateActiveCount",value:function(t){this._activeCount.textContent="".concat(t," items left")}},{key:"createTodoElement",value:function(t){var e=t.id,n=t.title,r=t.completed,o=s("li",{class:"todo-item",id:"todo-".concat(e)}),i=s("input",{type:"checkbox",class:"todo-check",id:e}),a=s("label",{class:"todo-label","data-id":e});return r&&(i.checked="checked",a.classList.add("completed")),a.textContent=n,o.appendChild(i),o.appendChild(a),o.addEventListener("click",this.handleToggle.bind(this)),o}},{key:"handleToggle",value:function(t){var e=t.currentTarget.querySelector("label"),n=e.classList.contains("completed"),r=Number(e.dataset.id);this.emit("toggle",{id:r,completed:n})}},{key:"handleInput",value:function(t){if("Enter"===t.key){var e=this._input.value;this.emit("add",e)}}},{key:"handleFilter",value:function(t){var e=L(t.target.classList,2)[1];e&&this.emit("filter",e)}},{key:"handleClear",value:function(){this.emit("clear")}}])&&A(e.prototype,n),r&&A(e,r),a}(f);function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}new(function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.model=e,this.view=n,this.view.on("add",this.addTodo.bind(this)),this.view.on("toggle",this.toggleTodo.bind(this)),this.view.on("filter",this.filterTodo.bind(this)),this.view.on("clear",this.clearTodo.bind(this)),this.view.on("drop",this.moveTodo.bind(this))}var e,n,r;return e=t,(n=[{key:"addTodo",value:function(t){var e=this.model.addItem({id:Date.now(),title:t,completed:!1});this.view.addTodo(e),this.view.updateActiveCount(this.model.updateActiveCount(e))}},{key:"toggleTodo",value:function(t){var e=t.id,n=t.completed,r=this.model.updateItem(e,{completed:!n}),o=r.completed?0:this.model.length-1;this.model.moveItemTo(r,o),this.view.updateTodo(r),this.view.updateActiveCount(this.model.updateActiveCount(r))}},{key:"filterTodo",value:function(t){var e=this.model.getFilteredTodos(t);this.view.load(e)}},{key:"clearTodo",value:function(){this.model.clearCompletedTodos(),this.view.load(this.model.items),this.view.updateActiveCount(this.model.activeCount)}},{key:"moveTodo",value:function(t){var e=t.dropzone,n=e.src,r=e.target,o=Number(n.querySelector("label").dataset.id),i=Number(r.querySelector("label").dataset.id),a=this.model.getItem(o),u=this.model.getItemIndex(o),c=this.model.getItemIndex(i),l=u-c==1?c+1:c;this.model.moveItemTo(a,l)}}])&&N(e.prototype,n),r&&N(e,r),t}())(new C,new F)}]);
//# sourceMappingURL=bundle.js.map